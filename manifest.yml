modules:
  confluence:homepageFeed:
    - key: rag-chatbot-main
      resource: main
      render: native
      resolver:
        function: resolver
      title: AI Knowledge Assistant
  confluence:globalPage:
    - key: rag-chatbot-admin
      resource: admin
      render: native
      resolver:
        function: resolver
      title: RAG Chatbot Admin
      conditions:
        - condition: user_is_admin
          params:
            users:
              - accountId: ${ADMIN_ACCOUNT_ID_1}
              - accountId: ${ADMIN_ACCOUNT_ID_2}
  function:
    - key: resolver
      handler: index.handler
  webtrigger:
    - key: aws-webhook
      function: aws-handler
resources:
  - key: main
    path: src/frontend/ChatbotMain.jsx
  - key: admin
    path: src/frontend/AdminPanel.jsx
app:
  runtime:
    name: nodejs22.x
    memoryMB: 512
    architecture: arm64
  id: ari:cloud:ecosystem::app/afb99660-3832-4d38-999f-a42df798d06a
permissions:
  content:
    - 'read'
    - 'write'
  storage:
    - 'read'
    - 'write'
  external:
    fetch:
      backend:
        - '*.amazonaws.com'
        - '*.openai.com'
      client:
        - '*.amazonaws.com'
